{% extends "core/layouts/base.html" %}
{% load static %}
{% block head_title %}
{{ schema.name }} - Schemas.Pub
{% endblock %}
{% block extra_head %}
<script src="{% static 'js/schema-detail.js' %}"></script>
{% endblock %}

{% block page_content %}
<main class="schema-detail">
  <h1>{{ schema.name }}</h1>
  <div class="content">
    <section class="sidebar">
      <ul class="badges">
      {% if latest_rfc %}
        <li>
          <a href="{{ latest_rfc.url }}" class="badge badge--rfc">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="icon--sm">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>
            RFC
          </a>
        </li>
      {% endif %}
      {% if latest_w3c %}
        <li>
          <a href="{{ latest_w3c.url }}" class="badge badge--w3c">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="icon--sm">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z" />
            </svg>
            W3C
          </a>
        </li>
      {% endif %}
      </ul>
      <h2 class="text--primary">Details</h2>
      <p>Added on {{ schema.created_at | date }}</p>
      <p>Managed by {{ schema.created_by }}</p>
      {% if latest_license %}
      <p><a href="{{ latest_license.url }}">License</a></p>
      {% endif %}
    </section>
    <section class="main-content">
      <ul class="tab-links">
        {% if latest_readme_content %}
        <li><button class="tab-link" data-tab-link="readme">README</button></li>
        {% endif %}
        {% for schemaref in schemarefs %}
        <li><button class="tab-link" data-tab-link="schema{{ forloop.counter }}">
            Schema {% if schema.schemaref_set.count > 1 %}{{ forloop.counter }}{% endif %}</button></li>
        {% endfor %}
        {% if schema.documentationitem_set.exists %}
        <li><button class="tab-link" data-tab-link="docs">Docs</button></li>
        {% endif %}
      </ul>
      <ul class="tabs">
        {% if latest_readme_content %}
        <li data-tab-id="readme" class="inactive-tab schema-tab">
          <div class="markdown">
            {{ latest_readme_content }}
          </div>
          {% if latest_readme_url %}
          <a href="{{ latest_readme_url }}">View source</a>
          {% endif %}
        </li>
        {% endif %}
        {% for schemaref in schemarefs %}
        <li data-tab-id="schema{{ forloop.counter }}" class="inactive-tab schema-tab">
          <pre class="schema-definition"><code>{{ schemaref.content|escape }}</code></pre>
          <a href="{{ schemaref.url }}">View source</a>
        </li>
        {% endfor %}
        {% if schema.documentationitem_set.exists %}
        <li data-tab-id="docs" class="inactive-tab schema-tab">
          <ul>
            {% for documentation_item in schema.documentationitem_set.all|dictsort:"name" %}
            <li><a href="{{documentation_item.url}}">{{documentation_item.name}}</a>
            {% endfor %}
          </ul>
        </li> 
        {% endif %}
      </ul>
    </section>
  </div>
</main>
{% endblock %}
