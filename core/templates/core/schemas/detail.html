{% extends "core/layouts/base.html" %}
{% load static %}
{% block head_title %}
{{ schema.name }} - Schemas.Pub
{% endblock %}
{% block extra_head %}
<script src="{% static 'js/schema-detail.js' %}"></script>
{% endblock %}

{% block page_content %}
<main class="schema-detail">
  <h1>{{ schema.name }}</h1>
  <div class="content">
    <section class="sidebar">
      <h2 class="text--primary">Details</h2>
      <p>Added on {{ schema.created_at | date }}</p>
      <p>Managed by {{ schema.created_by }}</p>
      {% if latest_license %}
      <p><a href="{{ latest_license.url }}">License</a></p>
      {% endif %}
    </section>
    <section class="main-content">
      <ul class="tab-links">
        {% if latest_readme_content %}
        <li><button class="tab-link" data-tab-link="readme">README</button></li>
        {% endif %}
        {% if latest_definition %}
        <li><button class="tab-link" data-tab-link="schema">Schema</button></li>
        {% endif %}
        {% if schema.documentationitem_set.exists %}
        <li><button class="tab-link" data-tab-link="docs">Docs</button></li>
        {% endif %}
      </ul>
      <ul class="tabs">
        {% if latest_readme_content %}
        <li data-tab-id="readme" class="inactive-tab schema-tab">
          <div class="markdown">
            {{ latest_readme_content }}
          </div>
          {% if latest_readme_url %}
          <a href="{{ latest_readme_url }}">View source</a>
          {% endif %}
        </li>
        {% endif %}
        {% if latest_definition %}
        <li data-tab-id="schema" class="inactive-tab schema-tab">
          <pre class="schema-definition"><code>{{ latest_definition|escape }}</code></pre>
          {% if latest_definition_url %}
          <a href="{{ latest_definition_url }}">View source</a>
          {% endif %}
        </li>
        {% endif %}
        {% if schema.documentationitem_set.exists %}
        <li data-tab-id="docs" class="inactive-tab schema-tab">
          <ul>
            {% for documentation_item in schema.documentationitem_set.all|dictsort:"name" %}
            <li><a href="{{documentation_item.url}}">{{documentation_item.name}}</a>
            {% endfor %}
          </ul>
        </li> 
        {% endif %}
      </ul>
    </section>
  </div>
</main>
{% endblock %}
